<!--pages/home/home.wxml-->
<scroll-view>
    <view class="home-container" bindtap="closeNotice">

        <!-- 轮播图 autoplay="true"3.0-->
        <swiper autoplay class="h-v2-swiper-item" circular="true" duration="300" indicatorActiveColor="#fff" indicatorColor="rgba(255,255,255,0.50)" indicatorDots interval="5000" bindchange="onSwiperChange">
            <block wx:for="{{imagesList.bannerImage}}" wx:for-index="swiperListIndex" wx:for-item="swiperListItem" wx:key="swiperListIndex">
                <swiper-item bindtap="navigateTo">
                    <navigator url="/pages/home/link?extendUrl={{swiperListItem.url}}" style="width: 100%;height: 100%;border-radius: 8rpx;">
                        <image src="{{swiperListItem.image}}" style="width: 100%;height: 100%;border-radius: 8rpx;"></image>
                    </navigator>
                </swiper-item>
            </block>
        </swiper>

        <!-- 轮播公告 3.0-->
        <view style="padding:0 30rpx 40rpx 36rpx;" wx:if="{{hasNotice}}">
            <view style="display: flex;justify-content:space-between;">
                <view class="notice-title">最新公告</view>
                <view class='notice-button' catchtap="handleshowAllNotice">查看更多</view>
            </view>
            <swiper class="notice-detail" circular="true" duration="500" vertical="true" autoplay="true">
                <block wx:for="{{noticeData}}" wx:key="{{index}}">
                    <swiper-item catchtap="handleshowOneNotice" data-onenotice="{{item}}">
                        {{item.noticeTitle}}
                    </swiper-item>
                </block>
            </swiper>
            <!-- <view class="notice-detail">积分规则变化详情</view> -->
        </view>

        <!--弹出公告-->
        <view class="modulebox-background-wrapper-notice" wx:if="{{showOneNotice}}">
            <view>
                <image src='/images/home/announcement_pic.png' class='modulebox-image'></image>
            </view>
            <swiper class="modulebox-wrapper-notice" circular="true" duration="500" autoplay="true" indicator-dots indicator-color='rgba(247,156,76,0.30)' indicator-active-color='#F79C4C'>
                <block wx:for="{{showedNoticeData}}" wx:key="{{index}}">
                    <swiper-item>

                        <block>
                            <view class='modulebox-notice-title'>
                                {{item.noticeTitle}}
                            </view>
                            <scroll-view scroll-y style='height:270rpx;'>
                                <view class="modulebox-notice-content">
                                    {{item.content}}
                                </view>
                            </scroll-view>
                        </block>
                    </swiper-item>
                </block>
            </swiper>

        </view>

        <!-- 开始点餐 3.0-->
        <view class="h-v3">
            <view class="h-v3-1" catchtap="handleGotoMenu">
                开始点餐
            </view>
            <view style="position:absolute;top:{{hasNotice?460:328}}rpx;height:100rpx;width:600rpx;margin-left:46rpx;z-index:-1;">
                <image src="/images/home/home_projection.png" style="height:100rpx;width:600rpx;"></image>
            </view>
        </view>
        <!-- 3个图标 3.0 -->
        <view class="label-wrapper">
            <view style="width:112rpx;text-align: center; " bindtap="handleGotoLabel" data-type="qianbao">
                <view style="margin-left:12rpx;height: 88rpx;width:88rpx;">
                    <image src='/images/home/home_balance.png' style="height: 88rpx;width:88rpx;"></image>
                </view>
                <view class="labelDes">我的余额</view>
            </view>
            <view style="width:88rpx;text-align: center; " bindtap="handleGotoLabel" data-type="youhuiquan">
                <view style=" height: 88rpx;width:88rpx;">
                    <image src='/images/home/home_coupon.png' style="height: 88rpx;width:88rpx;"></image>
                </view>

                <view class="labelDes">优惠券</view>
            </view>
            <view style="width:112rpx;text-align: center; " bindtap="handleGotoLabel" data-type="jifen">
                <view style="margin-left:12rpx;height: 88rpx;width:88rpx;">
                    <image src='/images/home/home_points.png' style="height: 88rpx;width:88rpx;"></image>
                </view>
                <view class="labelDes">我的积分</view>
            </view>
        </view>
        <!-- 首页提示取餐3.0-->
        <view wx:if='{{gethomeOrderList}}'>
            <view style="margin:60rpx 0 60rpx 30rpx;" wx:if="{{homeOrderList.length>0}}">
                <view class='takefood-title'>今日餐品</view>
                <view>
                    <swiper circular="true" next-margin='24rpx' style='width: 100%; height: 172rpx;'>
                        <block wx:for="{{homeOrderList}}" wx:for-index="homeOrderIndex" wx:for-item="homeOrderItem" wx:key="homeOrderIndex">
                            <swiper-item>
                                <view style="display: flex;" class="takefood-food">
                                    <view style="flex-shrink:0;">
                                        <image class="takefood-img" src="{{homeOrderItem.foodImage}}"></image>
                                    </view>
                                    <view>
                                        <view style='display: flex;'>
                                            <view style="margin-top:16rpx;flex-grow:1;">
                                                <view style="line-height:50rpx;display:flex;" wx:if='{{homeOrderItem.isBinding}}'>
                                                    <view class="takefood-cabinet-title">{{homeOrderItem.bindDes}}</view>
                                                    <view class="takefood-cabinet-number">
                                                        {{homeOrderItem.bindNumber}}
                                                    </view>
                                                </view>
                                                <view style="height:20rpx;" wx:else>

                                                </view>
                                                <view style="line-height: 52rpx;display:flex;">
                                                    <view class="takefood-mealType">
                                                        {{homeOrderItem.mealTypeShow}}</view>
                                                    <view class="takefood-foodname"> {{homeOrderItem.foodName}}
                                                    </view>
                                                    <view wx:if="{{homeOrderItem.foodQuantity>1}}" class='takefood-foodcount'>
                                                        x{{homeOrderItem.foodQuantity}}</view>
                                                </view>

                                            </view>
                                            <view class="takefood-button" style="flex-shrink:0;" bindtap="handleTakeOrder" data-ordercode="{{homeOrderItem.orderCode}}" data-isbinding="{{homeOrderItem.isBinding}}" data-binddes="{{homeOrderItem.bindDes}}" data-bindnumber="{{homeOrderItem.bindNumber}}">取餐</view>
                                        </view>
                                        <view class='takefood-time'>
                                            取餐时间: {{homeOrderItem.takeMealTimeDes}}
                                        </view>
                                    </view>
                                </view>
                            </swiper-item>
                        </block>
                    </swiper>
                </view>
            </view>
            <!-- 首页补餐 3.0-->
            <view class="add-wrapper" wx:else>
                <image src="/images/home/takefood.png" mode="widthFix" class="add-img">
                </image>
                <view class='add-title' catchtap='gotoAddfood'>去补餐</view>
            </view>

        </view>
        <!-- 活动3.0 -->
        <view class="promotion-wrapper">
            <view class="promotionItem" wx:for="{{imagesList.centerImage}}" wx:for-index="promotionListIndex" wx:for-item="promotionListItem" wx:key="promotionListIndex">
                <navigator url="/pages/home/link?extendUrl={{promotionListItem.url}}">
                    <image class="promotion-img" src="{{promotionListItem.image}}" />
                </navigator>
            </view>
        </view>
        <!-- foot 图片  -->
        <view class="newuser-wrapper-2">
            <image class="newuserimg" src="{{imagesList.footImage.image}}"></image>
        </view>

        <!-- --------------------------------------- 下面是各种弹出层 --------------------------------------- -->

        <!-- 用户授权框 弹出 2.6.1-->
        <view class="modulebox-background-wrapper" wx:if="{{showUserAuthFlag}}">
            <view class="modulebox-wrapper">
                <view class="modulebox-img-wrapper">
                    <image class="modulebox-img" src="/images/login/logo.png" mode="widthFix" style="width:100%;"></image>
                </view>
                <view class="modulebox-des">
                    欢迎来到点点餐订餐小程序
                </view>
                <button class="modulebox-button" open-type="getUserInfo" bindgetuserinfo="getWxUserInfo">微信授权</button>
            </view>
        </view>
        <!-- 审核状态框 弹出2.6.1 -->
        <view class="modulebox-background-wrapper" wx:if="{{showCheckFlag}}">
            <view class="modulebox-wrapper-organize">
                <view style='margin:32rpx 0 20rpx;text-align: center;'>
                    <image src="/images/mine/checking.jpg" style='width:216rpx;height:216rpx;'></image>
                </view>
                <view class='bind-title'>正在审核</view>
                <view class='bind-des'>企业审核会尽快完成，请耐心等待</view>

                <button class="modulebox-button" catchtap="handleRefreshUser">点击刷新</button>
            </view>
        </view>

        <!-- 新人大礼 弹出 2.6.1-->
        <view class="newuser-wrapper" wx:if="{{showDaliFlag}}">
            <view class="img-wrapper">
                <view class="icon-wrapper">
                    <image style='height:88rpx;width:88rpx;' src="/images/home/guanbi.png" catchtap="closeDali"></image>

                </view>
                <image class="image-dali" src="/images/home/new_user.png"></image>
                <view class='button-dali' catchtap="getNewUserGift">立即领取</view>
            </view>
        </view>
        <!-- layer弹出层 （优惠券活动 弹出） 2.6.1 -->
        <block wx:if="{{showLayerFlag}}">
            <c-discountPromotion bind:closelayer="onCloseLayer"></c-discountPromotion>
        </block>

        <!--选择预约3.0-->

        <view class="mask" wx:if="{{showMenuSelect}}" catchtouchmove="preventTouchMove"></view>

        <view style="position:fixed;bottom:0;width:100%; z-index:1001;background:#fff;" wx:if="{{showMenuSelect}}">
            <view class="appointment-title">
                选择预约
            </view>
            <view style="position:absolute;right:10rpx;top:10rpx;" catchtap='closeMenuSelect'>
                <image src='/images/home/filter_close.png' style="height:88rpx;width:88rpx;"></image>
            </view>
            <view class='appointment-choice-list'>
                <view style="display: flex;margin-bottom:20rpx;">
                    <block wx:if="{{appointmention=='today'}}">
                        <image src='/images/home/filter_checked.png' style="height:88rpx;width:88rpx;"></image>
                        <view class="appointment-choice-right-checked">预约今天 今天元气满满哦</view>
                    </block>
                    <block wx:else>
                        <image src='/images/home/filter_unchecked.png' style="height:88rpx;width:88rpx;" catchtap='handleSelectToday'></image>
                        <view class="appointment-choice-right" catchtap='handleSelectToday'>预约今天 今天元气满满哦</view>
                    </block>
                </view>
                <view style="display: flex;margin-bottom:20rpx;">
                    <block wx:if="{{appointmention=='tomorrow'}}">
                        <image src='/images/home/filter_checked.png' style="height:88rpx;width:88rpx;"></image>
                        <view class="appointment-choice-right-checked">预约明天 明天也要吃好呀</view>
                    </block>
                    <block wx:else>
                        <image src='/images/home/filter_unchecked.png' style="height:88rpx;width:88rpx;" catchtap='handleSelectTomorrow'></image>
                        <view class="appointment-choice-right" catchtap='handleSelectTomorrow'>预约明天 明天也要吃好呀</view>
                    </block>
                </view>
                <view style="display: flex;" catchtap='handleSelectWeek'>
                    <block wx:if="{{appointmention=='week'}}">
                        <image src='/images/home/filter_checked.png' style="height:88rpx;width:88rpx;"></image>
                        <view class="appointment-choice-right-checked">预约多天 一周都有好吃哒</view>
                    </block>
                    <block wx:else>
                        <image src='/images/home/filter_unchecked.png' style="height:88rpx;width:88rpx;"></image>
                        <view class="appointment-choice-right">预约多天 一周都有好吃哒</view>
                    </block>
                </view>
            </view>
            <view class='appointment-choice-foodtype-title' wx:if="{{appointmention!='week'}}">
                选择时餐
            </view>
            <view class="appointment-choice-foodtype-list" style="margin-bottom:30rpx;border-bottom: 1rpx solid #EBEBEB;" wx:if="{{appointmention!='week'}}">
                <block wx:for="{{twoDaysMealName}}" wx:key="{{index}}">
                    <block wx:if='{{oneDayInfo[item+"Status"]==true}}'>
                        <view style="position:absolute;width:750rpx;height:142rpx;background:rgba(255,255,255,0.8);z-index:1001;" wx:if='{{!oneDayInfo[item+"OrderStatus"]}}'>
                            <image src='/images/home/filter_end.png ' style="position:absolute; right:110rpx;  top:12rpx;width:120rpx;height:115rpx;"></image>
                        </view>
                        <view class='appointment-choice-foodtype' data-mealtype='{{item}}' catchtap="startOrderMenu">
                            <image src='/images/home/filter_{{item}}.png' style="height:120rpx;width:120rpx;"></image>
                            <view style="margin-left:30rpx;width:150rpx;flex-grow:1;">
                                <view class="appointment-choice-foodtype-name"> {{mealTypeMapSmall[item]}}</view>
                                <view class="appointment-choice-foodtype-deadlilne">
                                    <view>截止时间</view>
                                    <view style="margin-left:10rpx;">{{oneDayInfo[item+"deadlineDesc"]}}</view>
                                </view>
                            </view>
                            <image src='/images/home/filter_more.png' style="height:88rpx;width:88rpx; margin-top: 16rpx;"></image>
                        </view>

                    </block>
                </block>
            </view>
        </view>
    </view>
</scroll-view>